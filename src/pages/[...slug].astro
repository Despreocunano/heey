---
export const prerender = false;

import Layout from '../layouts/Layout.astro';
import HeroLanding from '../components/landing/HeroLanding.astro';
import ContenidoLanding from '../components/landing/ContenidoLanding.astro';
import { getLandingPageBySlug } from '../lib/contentful/queries/landingPages';

const { slug } = Astro.params;
console.log('Requested slug:', slug);

if (!slug) {
  console.log('No slug provided');
  return Astro.redirect('/404');
}

const landingPage = await getLandingPageBySlug(slug);
console.log('Landing page data:', landingPage);

if (!landingPage) {
  console.log('No landing page found');
  return Astro.redirect('/404');
}

const breadcrumb = [
  { label: 'Inicio', href: '/' },
  { label: landingPage.tituloPagina, href: `/${slug}`, current: true }
];
---

<Layout 
  title={landingPage.tituloPagina}
  description={landingPage.heroLanding.descripcion}
  breadcrumb={breadcrumb}
>
  <main>
    <HeroLanding hero={landingPage.heroLanding} />
    
    {landingPage.contenidoPgina.map((contenido) => (
      <ContenidoLanding 
        titulo={contenido.titulo}
        contenido={contenido.contenido}
      />
    ))}
  </main>
</Layout>
---
export const prerender = false;

import Layout from '../../layouts/Layout.astro';
import { getNoticiaBySlug } from '../../lib/contentful/queries/noticias';
import { documentToHtmlString } from '@contentful/rich-text-html-renderer';

const { slug } = Astro.params;
if (!slug) {
  return Astro.redirect('/404');
}

const noticia = await getNoticiaBySlug(slug);
if (!noticia) {
  return Astro.redirect('/404');
}

const contenidoHtml = documentToHtmlString(noticia.contenido);

const breadcrumb = [
  { label: 'Inicio', href: '/' },
  { label: 'Viajes', href: '/viajes' },
  { label: noticia.titulo, href: `/viajes/${noticia.slug}`, current: true }
];
---

<Layout 
  title={noticia.titulo}
  description={`Lee sobre ${noticia.titulo} y más artículos de viajes`}
  breadcrumb={breadcrumb}
>
  <main class="bg-white">
    <article class="max-w-4xl mx-auto px-4 py-12">
      <header class="mb-8">
        <h1 class="text-4xl font-bold text-gray-900 mb-4">
          {noticia.titulo}
        </h1>
        <img 
          src={noticia.imagen.url} 
          alt={noticia.imagen.title}
          class="w-full h-[400px] object-cover rounded-xl"
        />
      </header>

      <div 
        class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-p:text-gray-600"
        set:html={contenidoHtml}
      />
    </article>
  </main>
</Layout>
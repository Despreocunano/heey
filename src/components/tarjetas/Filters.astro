---
import type { Banco, TarjetaCredito } from '../../types/contentful';

interface Props {
  tarjetas: TarjetaCredito[];
  bancos: Banco[];
}

const { tarjetas, bancos } = Astro.props;

// Obtener categorías únicas de todas las tarjetas
const categorias = [...new Set(tarjetas.flatMap(t => t.categoria))].sort();

// Obtener marcas únicas de todas las tarjetas
const marcas = [...new Set(tarjetas.flatMap(t => t.marca))].sort();
---

<div class="bg-white rounded-lg shadow-sm p-6 mb-8">
  <h3 class="text-lg font-semibold text-gray-900 mb-4">Filtros</h3>
  
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Filtro por Categoría -->
    <div>
      <label for="categoria" class="block text-sm font-medium text-gray-700 mb-2">
        Categoría
      </label>
      <select
        id="categoria"
        name="categoria"
        class="filter-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500"
      >
        <option value="">Todas las categorías</option>
        {categorias.map(categoria => (
          <option value={categoria}>{categoria}</option>
        ))}
      </select>
    </div>

    <!-- Filtro por Banco -->
    <div>
      <label for="banco" class="block text-sm font-medium text-gray-700 mb-2">
        Banco
      </label>
      <select
        id="banco"
        name="banco"
        class="filter-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500"
      >
        <option value="">Todos los bancos</option>
        {bancos.map(banco => (
          <option value={banco.nombreBanco}>{banco.nombreBanco}</option>
        ))}
      </select>
    </div>

    <!-- Filtro por Marca -->
    <div>
      <label for="marca" class="block text-sm font-medium text-gray-700 mb-2">
        Marca
      </label>
      <select
        id="marca"
        name="marca"
        class="filter-select mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-lime-500 focus:ring-lime-500"
      >
        <option value="">Todas las marcas</option>
        {marcas.map(marca => (
          <option value={marca}>{marca}</option>
        ))}
      </select>
    </div>
  </div>
</div>

<script>
  import { CardFilters } from './filters/CardFilters';

  // Initialize filters
  document.addEventListener('astro:page-load', () => {
    new CardFilters();
  });
</script>